try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="4f7fd0a9-1fbd-4838-be5e-07b608a1fdf5",e._sentryDebugIdIdentifier="sentry-dbid-4f7fd0a9-1fbd-4838-be5e-07b608a1fdf5")}catch(e){}("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{}).SENTRY_RELEASE={id:"2c82cb25a14a55e3572d801ec920e9674e6cbd36"};(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[1565],{18864:(e,t,a)=>{a.d(t,{Ay:()=>y,rv:()=>g});var o=a(20038),s=a(34524),n=a(5298),i=a(8811),r=a(89625),c=a(16536);const d=["immersiveTakeover","custom","base"],l={immersiveTakeover:null,custom:i.V.default},u=(0,o.Z0)({name:"background",initialState:l,reducers:{unsetBackground:()=>l,setBackground:(e,t)=>{const{layer:a,background:o}=t.payload;e[a]=o}},selectors:{selectBackground:e=>{let t=i.V.default;return Object.values(d).some((a=>!!e[a]&&(t=e[a],!0))),"string"==typeof t?t:{...t}},selectIsImmersiveTakeover:e=>null!==e.immersiveTakeover}}),{unsetBackground:m,setBackground:p}=u.actions,{selectBackground:g,selectIsImmersiveTakeover:f}=u.selectors;(0,c.Zv)({type:n.yc.type,effect:(e,t)=>{const a=t.getState(),o=(0,n.K5)(a),s=g(a);if(!s?.sticky)if("preview"!==o)if("mystery"!==o)if("game"!==o)if("category"!==o)t.dispatch(m());else{const e=(0,n.N2)(a),o=(0,r.r)(e.id);t.dispatch(p({layer:"custom",background:o}))}else{const e=(0,n.Vv)(a),o=(0,r.P)(e);t.dispatch(p({layer:"custom",background:o}))}else{const{mystery:e}=i.V;t.dispatch(p({layer:"custom",background:e}))}else{const{preview:e}=i.V;t.dispatch(p({layer:"custom",background:e}))}}}),(0,c.Zv)({type:s.jO.type,effect:(e,t)=>{const{background:a}=e?.payload?.takeover?.config||{};a&&t.dispatch(p({layer:"immersiveTakeover",background:{...a,style:"dual-cover"}}))}}),(0,c.Zv)({type:s.jp.type,effect:(e,t)=>{t.dispatch(m())}});const y=u.reducer},34524:(e,t,a)=>{a.d(t,{$E:()=>U,$i:()=>O,Ay:()=>j,Fw:()=>C,GE:()=>K,HH:()=>G,I2:()=>Z,Lz:()=>x,MS:()=>z,Q5:()=>D,QB:()=>b,XB:()=>L,XZ:()=>_,eb:()=>B,i$:()=>P,i8:()=>M,iM:()=>T,j5:()=>R,jO:()=>E,jp:()=>I,mY:()=>V,nj:()=>H,o3:()=>w,oP:()=>F,sF:()=>k,th:()=>$,wt:()=>A});var o=a(20038),s=a(1081),n=a(48554),i=a(42891),r=a(5298),c=a(91323),d=a(11436),l=a(53210),u=a(15049),m=a(17782),p=a(73421),g=a(16345),f=a(28933),y=a(83569),v=a(35190);let h;try{navigator?.cookieDeprecationLabel&&navigator.cookieDeprecationLabel.getValue().then((e=>{h=e}))}catch{}const S=(0,o.Z0)({name:"ads",initialState:{takeover:null,pokiSDKLoaded:!1,adStackLoaded:!1,adStackReadyForLoad:!1,adBlocked:!1,mobileAdsOpportunity:!1,gameBarHouseAdCount:0,gameBarHouseAdEmpty:!1},reducers:{pokiSDKLoaded:e=>{e.pokiSDKLoaded=!0},adStackLoaded:e=>{e.adStackLoaded=!0},adBlocked:e=>{e.adBlocked=!0},startImmersiveTakeover:(e,t)=>{e.takeover=t.payload.takeover},stopImmersiveTakeover:e=>{e.takeover=null},setMobileAdsOpportunity:(e,t)=>{e.mobileAdsOpportunity=t.payload.allowed},countGameBarHouseAd:(e,t)=>{e.gameBarHouseAdEmpty=t.payload.isEmpty,e.gameBarHouseAdCount+=t.payload.isEmpty?0:1}},extraReducers:e=>{e.addCase(n.Br,(e=>{e.adStackReadyForLoad=!0,e.gameBarHouseAdCount=0,e.gameBarHouseAdEmpty=!1}))}}),k=(0,o.VP)("ads/refresh_display_ads"),w=(0,m.A)("ads/display_ad"),_=(0,m.A)("ads/refresh_ad"),b=(0,m.A)("ads/destory_ad_slot"),A=(0,o.VP)("ads/force_stop_ad_refresh"),P=(0,o.VP)("ads/cleanup_companion_ad"),{pokiSDKLoaded:L,adStackLoaded:G,adBlocked:D,startImmersiveTakeover:E,stopImmersiveTakeover:I,setMobileAdsOpportunity:B,countGameBarHouseAd:F}=S.actions,M=(0,s.Mz)(i.Kk,u.dR,u.lb,((e,t,a)=>{if("undefined"!=typeof window){const e=new URL(window?.location?.toString())?.searchParams?.get("force_ay_mode")||v.G8.NOT_APPLICABLE;if([v.G8.DISABLED,v.G8.PBS_ONLY,v.G8.DPF_ONLY,v.G8.CSTS_ONLY,v.G8.PBS_DPF_CSTS,v.G8.ON].includes(e))return console.warn("AY mode set by URL parameter:",e),e}return a||!t?v.G8.NOT_APPLICABLE:e>=4&&e<8?v.G8.PBS_ONLY:e>=8&&e<12?v.G8.DPF_ONLY:e>=12&&e<16?v.G8.DISABLED:v.G8.ON})),C=(0,s.Mz)(M,i.wu,((e,t)=>(0,f.J)(e,t))),O=(0,s.Mz)(d.m_,c.Gd,r.Vv,l.p,i.H6,M,((e,t,a,o,s,n)=>{const i={tag:"pg-v2c82cb25a14a55e3572d801ec920e9674e6cbd36",ab:Math.floor(100*Math.random()).toString(),experiment:o,page_has_mpu:"no",page_has_skyscraper:"no",page_has_lead:"no",cookieDepL:h,site_id:t.id,ay_mode:n};if(a&&(i["game-id"]=a.id,i.categories=(a.categories||[]).map((({id:e})=>e)),o&&(i.expid_content_gameid=`${o}|${a.id}`)),e&&(i.debug=e),!s){let e=3;const t=Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),a=Object.keys(p.xu);for(let o=0;o<a.length;o++){const s=Number(a[o]),n=p.xu[s]||0,i=p.xu[Number(a[o+1])]||1/0;if(t>=n&&t<=i){e=s;break}}i.page_has_lead="yes",e>=12&&(i.page_has_mpu="yes"),[9,11,17].includes(e)&&(i.page_has_skyscraper="yes")}return i}));function T(e){return e.ads.takeover}function x(e){return e.ads.pokiSDKLoaded}function R(e){return e.ads.adStackLoaded}function V(e){return e.ads.gameBarHouseAdCount}function z(e){return e.ads.gameBarHouseAdEmpty}const H=e=>e.ads.adBlocked,N=(0,s.Mz)(i.H6,(e=>e.ads.adStackReadyForLoad),((e,t)=>!e||t));function K(e){return e.ads.mobileAdsOpportunity}const $=(0,s.Mz)(x,i.Wv,N,((e,t,a)=>{(0,y.K)("selectAdStackReady:inputs",{sdkLoaded:e,consentSettled:t,adStackStartMoment:a});const o=e&&t&&a;return(0,y.K)("selectAdStackReady:result",{result:o}),o})),U=(0,s.Mz)(r.Vv,(e=>{const t=[];return e?.categories&&e.categories.forEach((e=>{e.iabCategories&&e.iabCategories.split(",").forEach((e=>{t.includes(e)||t.push(e)}))})),t.sort(),t})),Z=(0,s.Mz)(r.Vv,c.Gd,((e,t)=>{const a=(0,g.A)(),o=3===t.id?"Poki":t.domain_title;return{site:{name:o,domain:window.location.hostname,page:window.location.href,privacypolicy:1,publisher:{name:o,domain:t.domain},content:e?{id:`${e.id}`,title:e.title,url:window.location.href,sourcerelationship:1}:{}},device:{w:a.width,h:a.height}}})),j=S},42891:(e,t,a)=>{a.d(t,{Ay:()=>K,F8:()=>u,Fe:()=>B,H6:()=>G,Jj:()=>R,KM:()=>x,Kk:()=>N,Kn:()=>T,Mh:()=>z,Pl:()=>w,Rd:()=>M,SG:()=>d,W3:()=>O,Wv:()=>V,Xy:()=>l,Y1:()=>m,ac:()=>I,hG:()=>_,nx:()=>h,oJ:()=>D,pX:()=>S,qk:()=>E,rk:()=>P,vR:()=>F,wu:()=>b,xp:()=>L,zO:()=>H,zS:()=>C,zj:()=>A});var o=a(20038),s=a(1081),n=a(36774),i=a(91323);const r={bot:!1,cache:0,device:"desktop",isIpadOS:!1,isIos:!1,visibility:!0,history:[],geo:"NL",region:"NH",ccpaApplies:!1,host:"poki.com",viewportOrientation:"portrait",loadingPage:!1,recentGames:[],hydrated:!1,asyncEpicFired:!1,consentStatus:void 0,usPrivacyString:"1---",consistentRandomSeed:Math.random(),externalGames:{},isAdsBlockedVisible:!1,trafficSource:!1},c=(0,o.Z0)({name:"client",initialState:r,reducers:{hydrated:e=>{e.hydrated=!0},fireAsyncEpics:e=>{e.asyncEpicFired=!0},setConsentStatus:(e,t)=>{e.consentStatus=t.payload.consentStatus},setUSPrivacyString:(e,t)=>{e.usPrivacyString=t.payload.usPrivacyString},setDevice:(e,t)=>{e.device=t.payload.device},setGeo:(e,t)=>{e.geo=t.payload.geo},setRegion:(e,t)=>{e.region=t.payload.region},setTrafficSource:(e,t)=>{e.trafficSource=t.payload.trafficSource},setHost:(e,t)=>{e.host=t.payload.host},setViewportOrientation:(e,t)=>{e.viewportOrientation=t.payload.orientation},storeRecentGame:(e,t)=>{const{recentGames:a,siteID:o}=t.payload;e.recentGames={...e.recentGames,[o]:a}},setConsistentRandomSeed:(e,t)=>{e.consistentRandomSeed=t.payload.rand},setConsentExternalHostedGame:(e,t)=>{const{gameId:a}=t.payload;e.externalGames={...e.externalGames,[a]:!0}},setAdsBlockedVisible:(e,t)=>{e.isAdsBlockedVisible=t.payload.isVisible}}}),{hydrated:d,fireAsyncEpics:l,setConsentStatus:u,setUSPrivacyString:m,setDevice:p,setGeo:g,setRegion:f,setTrafficSource:y,setHost:v,setViewportOrientation:h,storeRecentGame:S,setConsistentRandomSeed:k,setConsentExternalHostedGame:w,setAdsBlockedVisible:_}=c.actions;function b(e){return e.client.geo}function A(e){return e.client.region}function P(e){return e.client.viewportOrientation}const L=e=>e.client.device;function G(e){const{device:t}=e.client;return"tablet"===t||"mobile"===t}const D=e=>e.client.ccpaApplies,E=(0,s.Mz)((e=>e.client.geo),(e=>n._k.includes(e))),I=e=>e.client.loadingPage&&e.client.hydrated,B=(0,s.Mz)(i.Gd,(e=>e.client.recentGames),((e,t)=>e&&t&&t[e.id]?t[e.id]:[])),F=(0,s.Mz)(B,(e=>e.reduce(((e,t)=>e+t.pt),0))),M=e=>e.client.consistentRandomSeed,C=e=>e.client.isIpadOS,O=e=>e.client.isIos,T=e=>e.client.usPrivacyString;function x(e,t){const{externalGames:a}=e.client;return a[t]||!1}const R=e=>e.client.isAdsBlockedVisible,V=(0,s.Mz)((e=>e.client.consentStatus),D,E,((e,t,a)=>t||!a||e===n.T2)),z=e=>e.client.asyncEpicFired,H=e=>e.client.trafficSource,N=()=>{const e="undefined"!=typeof window&&window?.context?.session?.id;if(!e)return 100;let t=0;for(let a=0;a<e.length;a++)t+=e.charCodeAt(a);return t%100},K=c},48554:(e,t,a)=>{a.d(t,{Ay:()=>Se,Br:()=>G,Co:()=>z,FK:()=>le,Kj:()=>ie,QE:()=>te,QX:()=>oe,Rk:()=>U,TQ:()=>M,UO:()=>ae,be:()=>ue,cD:()=>X,gO:()=>$,h8:()=>F,iG:()=>B,iw:()=>Z,kK:()=>C,kj:()=>re,lT:()=>ne,lh:()=>I,m$:()=>W,on:()=>R,pT:()=>de,qA:()=>Y,u9:()=>O,vA:()=>j,wZ:()=>D,wj:()=>ce,yd:()=>ee,yq:()=>E,zM:()=>se});var o=a(20038),s=a(8120),n=a(5298),i=a(42891),r=a(79906),c=a(89385),d=a(15203),l=a(25733),u=a(10179),m=a(40890),p=a(13150),g=a(46493),f=a(17782),y=a(16536),v=a(73934),h=a(83228),S=a(46278),k=a(65995),w=a(61363);const _={isFullscreen:!1,wasFullscreen:!1,showAdStatus:!1,adStatusEvent:"",adDuration:0,adCurrentTime:0,loadingFinished:!1,lastCloudSaveTimestamp:0,mobileNavPosition:void 0},b=(0,S.T5)(),A=`${b}/players/gamesave`,P=`${b}/auth/issue-token`,L=(0,o.Z0)({name:"game",initialState:_,reducers:{setFullscreen:(e,t)=>{e.isFullscreen=t.payload.toggle,e.wasFullscreen=e.wasFullscreen||t.payload.toggle},setGameLoadingFinished:(e,t)=>{e.loadingFinished=t.payload},setPubHostData:(e,t)=>{const{gameId:a,data:o}=t.payload;e[a]={...e[a],pubHostData:o}},showAdStatus:e=>{e.showAdStatus=!0},hideAdStatus:e=>{e.showAdStatus=!1},setAdStatusEvent:(e,t)=>{e.adStatusEvent=t.payload.event},setAdDurationAndProgress:(e,t)=>{e.adDuration=t.payload.duration,e.adCurrentTime=t.payload.currentTime},setLastCloudSaveTimestamp:(e,t)=>{e.lastCloudSaveTimestamp=t.payload},setMobileNavPosition:(e,t)=>{const{topPercent:a,topPx:o}=t.payload;e.mobileNavPosition={topPercent:a,topPx:o}}},extraReducers:e=>{e.addCase(n.yc,(e=>{e.mobileNavPosition=void 0}))}}),G=(0,f.A)("game/boot"),D=(0,f.A)("game/receive_game_event"),E=(0,f.A)("game/receive_sdk_details"),I=(0,f.A)("game/request_full_screen"),B=(0,f.A)("game/pub_host_initialized"),F=(0,f.A)("game/set_poki_url_params"),M=(0,f.A)("game/receive_command"),C=(0,f.A)("game/generate_screenshot"),O=(0,f.A)("game/receive_screenshot"),T=(0,f.A)("game/receive_score"),x=(0,f.A)("game/forward_game_event"),R=(0,f.A)("game/fetch_save_game"),V=(0,o.VP)("game/mutate_save_game"),z=(0,f.A)("game/cloud_save_game_script_error"),H=(0,f.A)("game/poki_accounts_open_auth_panel"),N=(0,f.A)("game/poki_accounts_get_user_token"),K=(0,f.A)("game/open_external_link"),{setFullscreen:$,setGameLoadingFinished:U,setPubHostData:Z,showAdStatus:j,hideAdStatus:W,setAdStatusEvent:X,setAdDurationAndProgress:Y,setLastCloudSaveTimestamp:J,setMobileNavPosition:q}=L.actions,Q=(0,s.Mz)(n.Vv,(e=>e.game),((e,t)=>t[e&&e.id]||{}));function ee(e){const t=Q(e);return t?.pubHostData||null}function te(e){const t=(0,n.Vv)(e);return!!t?.fullscreen}const ae=(0,s.Mz)(n.Vv,i.zS,n.K5,d.Bi,((e,t,a,o)=>"game"===a?"flash"===e?.file?.render_type||e?.alternative_game_enabled||t&&!e?.mobile_available:"mystery"===a&&!o)),oe=e=>e.game.isFullscreen,se=e=>e.game.wasFullscreen,ne=e=>e.game.showAdStatus,ie=e=>e.game.adStatusEvent,re=e=>e.game.adDuration,ce=e=>e.game.adCurrentTime,de=e=>e.game.loadingFinished,le=e=>e.game.lastCloudSaveTimestamp,ue=e=>e.game.mobileNavPosition,me={pubHostInitialized:B,[p.oQ]:D,[p.Oi]:E,[p.AU]:F,[p.zR]:M,[p.RC]:O,[p.Zf]:T,[p.vO]:x,[p.Kt]:H,[p.Xo]:N,[p.W2]:K,[p.IW]:q,fetchSaveGame:R,mutateSaveGame:V,SaveGameMigrator:!0},pe=["localhost","games.poki.com","game-cdn.poki.com"],ge=["pokiMessageEvent","pokiMessageDebug","SaveGameMigrator"];function fe({event:e,dispatch:t}){const a=function({event:e}){const{type:t}=e.data||{};if(!t||!me[t])return!1;if("function"!=typeof me[t]&&!ge.includes(t))return!1;const a=(0,m.aX)(e.origin)||"",o=pe.includes(a)||a.endsWith(".poki-gdn.com")||window.location.origin===e.origin,s=document.querySelector('iframe[name="gameFrame"]'),n=s&&s.src.startsWith(e.origin);return o||n}({event:e});if(!a)return;const{content:o,type:s}=e.data;if(ge.includes(s)&&(0,g.F)({category:"sdk",action:"message",data:{content:o,type:s}}),"function"==typeof me[s]){const a=e.source;t(me[s]({...o,source:a}))}}(0,y.Zv)({type:i.Xy.type,effect:(e,t)=>{const{dispatch:a}=t;void 0!==window.pokiMessageListener&&window.removeEventListener("message",window.pokiMessageListener),window.pokiMessageBuffer&&window.pokiMessageBuffer.forEach((e=>{fe({event:e,dispatch:a})})),window.addEventListener("message",(e=>{fe({event:e,dispatch:a})}))}});const ye=(0,o.zD)("game/push_save_game_to_cloud",(async({gameID:e,saveGameData:t},a)=>{const o=t.playtime||0;try{const s=JSON.stringify({ls:t.ls,idb:t.idb}),n=new Blob([s]).size;let i=s,r=n,d=1,l=!0;try{i=await(0,v.B)(s),r=i.size,d=r/n}catch(e){l=!1,console.error(e)}if(console.info(`[SaveGame] Compression results - Original: ${n/1024}KB, Compressed: ${r/1024}KB, Compression ratio: ${(100*d).toFixed(2)}% of the original size`),r>h.Im)return console.error(`[SaveGame] Game file is too large after compression ${r/1048576}mb`),(0,g.F)({category:"account",action:"gamesaveSizeTooLarge",data:{gameId:e,size:r,originalSize:n,compressionRatio:d}}),void a.dispatch((0,c.hK)({gameID:e,saveGameSize:r}));const u={"X-Poki-Pt":o.toString(),"X-Poki-Api-Version":"v2"};l&&(u["Content-Encoding"]="gzip"),a.dispatch(J(Date.now()));const m=await fetch(`${A}/${e}`,{method:"POST",body:i,credentials:"include",headers:u});if(!m.ok)throw new Error(`Failed to save user games: ${m.status}`);const p=m.headers.get("Etag");p&&window.frames?.gameFrame?.postMessage?.({type:"pokiSetEtag",etag:p},"*"),(0,g.F)({category:"account",action:"gamesaveSuccess",data:{gameId:e,size:r,originalSize:n,compressionRatio:d}});const f=new Date;console.info(`[SaveGame] cloud sync - game: ${e}, at: ${f.toLocaleString()}`)}catch(t){console.error("[SaveGame] error pushing to cloud",t),(0,g.F)({category:"account",action:"gamesaveError",data:{gameId:e,method:"pushSaveGameToCloud",context:"sending gamesave to the cloud",error:t instanceof Error?`${t.name}: ${t.message}`:String(t)}})}}));(0,y.Zv)({type:V.type,effect:(e,t)=>{const a=t.getState(),o=(0,n.Vv)(a)?.id,s=(0,c.Ep)(a),i=(0,c.Fh)(a);if(!s||!o||i.includes(o))return;if((0,h.jJ)(e.payload))return;const r={playtime:parseInt(e.payload.metadata?.playtime||"0",10),ls:e.payload.ls||"",idb:e.payload.idb||""};t.dispatch(ye({gameID:o,saveGameData:r}))}});const ve=Math.random().toString(36).substring(2);(0,y.Zv)({actionCreator:c.hK,effect:(e,t)=>{const{saveGameSize:a}=e.payload,o=ee(t.getState()),{gameID:s,gameVersion:n}=o||{},i={name:"LargeGameSave",message:`Game state of ${(a/1024/1024).toFixed(2)}MB is too large to sync to Poki User Account (max 1MB allowed)`},r=JSON.stringify({gid:s,vid:n,ve:7,n:i.name,m:i.message,ui:ve}),c=`${S.N8}/ge`;fetch(c,{method:"POST",body:r})}}),(0,y.Zv)({type:H.type,effect:(e,t)=>{const a=t.getState(),o=(0,c.ij)(a),s=(0,n.Vv)(a)?.id,i=e.version||0;if(!o){let o="unknown";switch(i){case 0:o=`sdk-${s}`;break;case 1:o=e.trigger}t.dispatch((0,c.qf)({source:o})),(0,g.F)({category:"account",action:"sdkOpenAuthPanel",data:{source:o,gameID:(0,n.Vv)(a)?.id}})}}}),(0,y.Zv)({type:N.type,effect:async(e,t)=>{const a=t.getState(),o=(0,n.Vv)(a)?.pokifordevs_game_id,s=(0,c.Ep)(a),i=e=>{window.frames?.gameFrame?.postMessage?.({type:"pokiAccountsUserToken",token:null,error:e},"*")};if(!o)return void i("No gameID found");if(!s)return void i("User is not logged in");let r,d;try{r=await fetch(`${P}?game_id=${o}`,{method:"GET",credentials:"include"})}catch(e){return console.error(e),void i("Network error while generating token")}if(r.ok){try{d=await r.json()}catch{return void i("Failed to parse user token")}window.frames?.gameFrame?.postMessage?.({type:"pokiAccountsUserToken",token:d.token},"*")}else i("Failed to generate user token")}}),(0,y.Zv)({type:T.type,effect:(e,t)=>{const{leaderboard:a,score:o,timeOnPage:s}=e.data;let{meta:i}=e.data;const r=t.getState(),d=(0,n.Vv)(r);if(!d||!d.pokifordevs_game_id)return;const l=(0,c.IT)(r);i||(i={time_on_page:Math.round(s)}),(0,k.g)(a,o,i,d.pokifordevs_game_id,l?.identity?.id)}}),(0,y.Zv)({type:x.type,effect:e=>{if(window.pokiBotDetected?.length>0)return;const{payload:t}=e,a=(0,l.v)();t.pageview_id=a.page.pageview_id;const o=`${S.N8}/game-event`;fetch(o,{method:"POST",headers:{"Content-Type":"text/plain"},body:JSON.stringify(t),mode:"no-cors",keepalive:!0,credentials:"omit"}).catch((e=>{console.warn("%cPOKI:%c failed to submit game event","font-weight: bold","",e)}))}}),(0,y.Zv)({type:K.type,effect:(e,t)=>{const{params:{url:a}}=e;if(a&&"string"==typeof a)try{const e=new URL(a);t.dispatch((0,r.mi)({modal:{id:w.HEADSUP_MODAL_ID,iconDesktop:"exclamation",iconMobile:"exclamationLarge",childComponent:{name:"modals/HeadsUpModal",props:{externalLinkURL:e.toString()}}}}))}catch{console.error("Invalid external link URL format:",a)}}});let he=!1;(0,y.Zv)({predicate:e=>(0,o.i0)(u.sx.rejected,n.yc)(e)||e.type===D.type,effect:(e,{getState:t,dispatch:a})=>{if(u.sx.rejected.match(e)&&(he=!0),!u.sx.rejected.match(e)&&!he)return;if(e.type===D.type&&e.event!==p.zY)return;const o=t();if((0,c.Ep)(o))return;(0,i.vR)(o)>=3600&&a((0,r.mi)({modal:{id:w.POWERUSER_MODAL_ID,iconDesktop:"clock",iconMobile:"clockLarge",showCloseButtonInHeader:!0,childComponent:{name:"modals/PowerUserModal"}}}))}});const Se=L},89385:(e,t,a)=>{a.d(t,{Ay:()=>D,Cf:()=>b,Ep:()=>y,Fh:()=>h,Gw:()=>v,IT:()=>p,QF:()=>g,V1:()=>_,Z:()=>S,bW:()=>L,hK:()=>P,iJ:()=>m,ij:()=>f,qf:()=>w});var o=a(20038),s=a(10179),n=a(88800),i=a(42891),r=a(98708),c=a(11436),d=a(16536),l=a(46493),u=a(52694);const m=e=>e.account.status,p=e=>e.account.session,g=e=>e.account.flow,f=e=>e.account.isPanelVisible,y=e=>200===e.account.status,v=e=>e.account.wasLoggedInBefore,h=e=>e.account.disabledSaveGames,S=e=>e.account.source,k=(0,o.Z0)({name:"account",initialState:{status:null,session:null,flow:null,isPanelVisible:!1,source:null,wasLoggedInBefore:!1,disabledSaveGames:[],hasPasskeySupport:!0},reducers:{toggleAccountPanel:(e,t)=>{e.isPanelVisible=!e.isPanelVisible,e.source=t?.payload?.source||null;const a=e.isPanelVisible?"hidden":"auto";document.body.style.overflow=a,!e.isPanelVisible&&window.frames?.gameFrame?.postMessage&&window.frames.gameFrame.postMessage?.({type:"pokiAccountsAuthPanelClosed"},"*")},setAccountSource:(e,t)=>{e.source=t.payload.source},setWasLoggedInBefore:e=>{e.wasLoggedInBefore=!0},setFlow:(e,t)=>{let a=t.payload.flowData;const o=(e=>e.account.hasPasskeySupport)({account:e});a=(0,u.py)(a),o||(a=(0,u.rn)(a)),e.flow=a},setDisabledSaveGames:(e,t)=>{e.disabledSaveGames.includes(t.payload.gameID)||e.disabledSaveGames.push(t.payload.gameID)},setHasPasskeySupport:(e,t)=>{e.hasPasskeySupport=t.payload.hasPasskeySupport}},extraReducers:e=>{e.addCase(s.sx.fulfilled,((e,t)=>{const a=t.payload;e.session=a,e.status=200})),e.addCase(s.sx.rejected,(e=>{e.session=null,e.status=401}))}}),{toggleAccountPanel:w,setFlow:_,setWasLoggedInBefore:b,setHasPasskeySupport:A,setDisabledSaveGames:P,setAccountSource:L}=k.actions;(0,d.Zv)({actionCreator:s.sx.fulfilled,effect:(e,t)=>{const a=t.getState(),o=p(a),n=o?.identity?.is_first_login,i=o?.identity?.id||"unknown",r=o?.authentication_method||"unknown",c=new URL(window.location.href).searchParams.get("accountSource");t.dispatch(b()),n?((0,l.F)({category:"account",action:"registerSuccess",label:r,data:{accountId:i,source:c}}),t.dispatch((0,s.jE)())):(0,l.F)({category:"account",action:"loginSuccess",label:r,data:{accountId:i,source:c}})}}),(0,d.Zv)({actionCreator:s.sx.rejected,effect:async(e,t)=>{const a=await(0,u.ec)();t.dispatch(A({hasPasskeySupport:a})),(0,l.F)({category:"account",action:"hasPasskeySupport",label:a?"true":"false"})}});let G=null;(0,d.Zv)({matcher:(0,o.i0)(s.sx.fulfilled,s.sx.rejected),effect:(e,{unsubscribe:t})=>{window.addEventListener("message",(e=>{if("pokiAccountsGetUserInfo"===e?.data?.type){if(null===G){const e=window.store?.getState();if(!e)return console.error("No store found to get account state"),void window.frames?.gameFrame?.postMessage?.({type:"pokiAccountsUserInfo",enabled:!1,session:null},"*");G=p(e)}window.frames?.gameFrame?.postMessage?.({type:"pokiAccountsUserInfo",enabled:!0,session:{id:G?.id||""}},"*")}})),t()}}),(0,d.Zv)({type:i.SG.type,effect:(e,{getState:t,dispatch:a,unsubscribe:o})=>{o();const s=t(),i=(0,c.fn)(s),d=f(s),l=i.includes("flow="),u=i.includes("id="),m=i.includes("trigger_registration="),p=i.includes("accountSource=");if((l||m)&&!d){let e="url";m&&p&&(e=new URLSearchParams(i).get("accountSource")),a(w({source:e}))}if(u){const e=(0,r.K)(s).search_broken,t=new URL(window.location.href);t.searchParams.delete("id"),window.history.replaceState({},document.title,t.toString()),a((0,n.Gg)({notification:{title:e,clickOutsideToClose:!0,autoExpire:8e3}}))}}});const D=k}}]);
//# sourceMappingURL=client~main-9b68f587~dc99bda447888dea0fc2.js.map